(function(){"use strict";var e={8185:function(e,t,n){var r=n(9242),i=n(3396);const o={key:0};function l(e,t,n,r,l,s){const a=(0,i.up)("router-link"),c=(0,i.up)("router-view");return(0,i.wg)(),(0,i.iD)(i.HY,null,["pdf-printer"!==e.$route.name?((0,i.wg)(),(0,i.iD)("nav",o,[(0,i.Wm)(a,{class:"nav-element",to:{name:"home"}},{default:(0,i.w5)((()=>[(0,i.Uk)("Home")])),_:1}),(0,i.Wm)(a,{class:"nav-element",to:{name:"pdf-generator"}},{default:(0,i.w5)((()=>[(0,i.Uk)("Application")])),_:1})])):(0,i.kq)("",!0),(0,i.Wm)(c)],64)}var s=n(65),a={computed:{...(0,s.Se)(["readyToPrint"])}},c=n(89);const d=(0,c.Z)(a,[["render",l]]);var u=d,h=n(2483);function p(e,t,n,r,o,l){const s=(0,i.up)("Home");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s)])}n(7658);const m=(0,i._)("div",{class:"background"},null,-1),f={class:"main-container"},b=(0,i._)("h1",null," AD PDF CREATOR ",-1),v=(0,i._)("p",null," With this AD PDF CREATOR tool, you will be able to get a stylish PDF document from the excel file with just one step. ",-1),w=(0,i._)("ol",null,[(0,i._)("li",null," Set the preparation and checked value with the initials of the people that did it. "),(0,i._)("li",null," Import the excel file with all the information. "),(0,i._)("li",null," Once the excel file is imported, select the sheet you want to get as PDF. "),(0,i._)("li",null,[(0,i.Uk)(" After these settings, there are 2 number parameters: the height coefficient corrector and the max number of row span. The first one is to regulate the space for the table in the pages, the closest to 1 the less space will be left, and otherwise. The default number is the recommended, if there are some pages with the header moved to the top, reduce this number to get a more will distributed space for the pdf pages. The max rowspan value is to set the maximum rows that are span inside the excel sheet about to transform. Rarely it will be cases with more than 30 rows spanned, but in case there are, set this parameter correctly. "),(0,i._)("br"),(0,i.Uk)(' If there are a lot of rows (like in the AIRFRAME sheet), the program may can not create the pdf in 1 document. For these cases, a message will display showing that there is a problem. To solve it you will have to select the "split in 2" option. Then, you will get 2 documents (instead of 1) that can be join later on with any PDF tool. ')]),(0,i._)("li",null," Once all the setup is done, the TRANSFORM button will be activated, click it to start the transformation. "),(0,i._)("li",null,' With the PDF created, click the download button to open a new tab with the PDF document ready to be printed. In the cases where the "split in 2" option is selected, 2 new tabs will be opened. Allow for this site to open an emergent window if asks, it will be the 2nd half of the document. '),(0,i._)("li",null," Finally, once the new tab is opened, print the pages with Ctrl+P, and before start the printing, set the printer to “save as PDF”, set the page size as A4, unselect the “print the header and footer” option, and set the margins to none. ")],-1);function g(e,t,n,r,o,l){return(0,i.wg)(),(0,i.iD)("div",null,[m,(0,i._)("div",f,[b,v,(0,i._)("p",null,[(0,i.Uk)(" For that, go to the "),(0,i._)("button",{class:"inline-btn",onClick:t[0]||(t[0]=t=>e.$router.push({name:"pdf-generator"}))},"APPLICATION"),(0,i.Uk)(" tab follow these next steps: ")]),w])])}var y={name:"Home"};const _=(0,c.Z)(y,[["render",g]]);var k=_,$={name:"HomeView",components:{Home:k}};const P=(0,c.Z)($,[["render",p]]);var x=P;function T(e,t,n,r,o,l){const s=(0,i.up)("PDFGenerator");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s)])}var F=n(7139);const A=(0,i._)("div",{class:"background"},null,-1),C={id:"main-container",class:"p-5 text-center border rounded-5 shadow bg-white"},D={class:"inputs-container"},S={class:"name-inputs-container"},O=(0,i._)("p",null," Prepared by: ",-1),j=(0,i._)("p",null," Checked by: ",-1),H={class:"excel-selector-containers"},M={class:"file-input-container"},R=(0,i._)("p",null," Select the excel file: ",-1),N={class:"worksheet-selector-container"},E=(0,i._)("p",null," Select the sheet: ",-1),U=["disabled"],L={key:0,value:""},I=(0,i._)("p",null,"-- select an option --",-1),W=[I],q=["value"],z={class:"printed-parameters-container"},G=(0,i._)("p",null," Set the table height coeficient corrector: ",-1),V=(0,i._)("p",null," Set the maximum value of rowspan in the excel file: ",-1),Z={class:"checkbox-container"},B=(0,i._)("label",{for:"checkbox-split"}," Split the document in 2 ",-1),Y={class:"buttons-container"},K=(0,i._)("div",{id:"test-page",class:"prinet-container hidden"},null,-1),J=(0,i._)("button",{id:"modal-btn",type:"button",class:"btn btn-primary hidden","data-bs-toggle":"modal","data-bs-target":"#msgModal"}," Launch demo modal ",-1),Q={class:"modal fade",id:"msgModal",tabindex:"-1","aria-labelledby":"msgModalLabel","aria-hidden":"true"},X={class:"modal-dialog"},ee={class:"modal-content"},te=(0,i._)("div",{class:"modal-header"},[(0,i._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ne={class:"modal-body"};function re(e,t,n,o,l,s){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",null,[A,(0,i._)("div",C,[(0,i._)("div",D,[(0,i._)("div",S,[(0,i._)("div",null,[O,(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.prepared=e)},null,512),[[r.nr,l.prepared]])]),(0,i._)("div",null,[j,(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>l.checked=e)},null,512),[[r.nr,l.checked]])])]),(0,i._)("div",H,[(0,i._)("div",M,[R,(0,i._)("input",{id:"input-file",class:"form-control",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel, .xlsm",onChange:t[2]||(t[2]=(...e)=>s.readFile&&s.readFile(...e))},null,32)]),(0,i._)("div",N,[E,(0,i.wy)((0,i._)("select",{class:(0,F.C_)([""===l.workbook?"disabled-select":""]),disabled:""===l.workbook,"onUpdate:modelValue":t[3]||(t[3]=e=>l.worksheet=e)},[0===l.worksheet.length?((0,i.wg)(),(0,i.iD)("option",L,W)):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.workbook.SheetNames,((e,t)=>((0,i.wg)(),(0,i.iD)("option",{key:t,value:e},(0,F.zw)(e),9,q)))),128))],10,U),[[r.bM,l.worksheet]])])])]),(0,i._)("div",z,[(0,i._)("div",null,[G,(0,i._)("div",null,[(0,i._)("button",{onClick:t[4]||(t[4]=()=>{this.tableHeightCorrector>.5&&(this.tableHeightCorrector-=.01),this.tableHeightCorrector=Math.round(100*this.tableHeightCorrector)/100})},"➖"),(0,i._)("p",null,(0,F.zw)(l.tableHeightCorrector),1),(0,i._)("button",{onClick:t[5]||(t[5]=()=>{this.tableHeightCorrector<1&&(this.tableHeightCorrector+=.01),this.tableHeightCorrector=Math.round(100*this.tableHeightCorrector)/100})},"➕")])]),(0,i._)("div",null,[V,(0,i._)("div",null,[(0,i._)("button",{onClick:t[6]||(t[6]=()=>{this.maxRowsspan>1&&this.maxRowsspan--,this.maxRowsspan=Math.round(this.maxRowsspan)})},"➖"),(0,i._)("p",null,(0,F.zw)(l.maxRowsspan),1),(0,i._)("button",{onClick:t[7]||(t[7]=()=>{this.maxRowsspan++,this.maxRowsspan=Math.round(this.maxRowsspan)})},"➕")])]),(0,i._)("div",Z,[(0,i.wy)((0,i._)("input",{id:"checkbox-split",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>l.splitIn2=e)},null,512),[[r.e8,l.splitIn2]]),B])]),(0,i._)("div",Y,[(0,i._)("button",{class:(0,F.C_)(["btn btn-primary",[""===this.worksheet||""===this.prepared||""===this.checked?"disabled":""]]),onClick:t[9]||(t[9]=(...e)=>s.transformFile&&s.transformFile(...e))},"TRANSFORM",2),(0,i._)("button",{class:(0,F.C_)(["btn",[""===this.html?"disabled btn-secondary":"btn-success"]]),onClick:t[10]||(t[10]=(...e)=>s.downloadPDF&&s.downloadPDF(...e))},"DOWNLOAD",2)])]),K]),J,(0,i._)("div",Q,[(0,i._)("div",X,[(0,i._)("div",ee,[te,(0,i._)("div",ne,(0,F.zw)(l.msg),1)])])])])}const ie=n(7092);var oe={name:"PDFGenerator",data(){return{workbook:"",worksheet:"",prepared:"",checked:"",maxTableHeight:180,tableHeightCorrector:navigator.userAgent.includes("Firefox")?.9:.98,maxRowsspan:30,splitIn2:!1,msg:"",html:""}},computed:{...(0,s.Se)(["readyToPrint"])},methods:{...(0,s.OI)(["setReadyToPrint","setHTMLToPrint"]),readFile(){const e=document.querySelector("#input-file");this.file=e.files[0];const t=new FileReader;t.onload=e=>{const t=e.target.result,n=ie.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){const e=this.worksheet,t=this.workbook.Sheets[e],n=Array.apply(null,Array(17)).map(((e,t)=>`col${t}`)),r=ie.utils.sheet_to_json(t,{header:n});let i=0;while(i<10){if(Object.values(r[i]).includes("AD REF"))break;i++}const o=r.slice(0,i),l=r.slice(i,i+3);let s;s="end of report"===Object.values(r.slice(-1)[0])[0].toLowerCase()?r.slice(i+3,-1):r.slice(i+3);const a=function(e,t){return t?o.map((t=>{let n;if(Object.values(t).forEach((t=>{t.includes(e)&&(n=t.includes(": ")?t:t.replace(":",": "))})),n)return n})).filter((e=>void 0!==e)):e+" "+o.map((t=>{if(Object.values(t).includes(e)){const n=Object.values(t).indexOf(e);return Object.values(t)[n+1]}})).filter((e=>void 0!==e))},c=`\n        <div class="first-row-header">\n          <div class="img-header-container">\n            <img src="Airbus_Logo_2017.svg.png">\n          </div>\n          <div class="title-header-container">\n            <p>${a("Airworthiness Directives",!0)}</p>\n          </div>\n          <div class="valid-header-container">\n            <p>${a("Valid as of",!0)}</p>\n          </div>\n        </div>\n        <div class="second-row-header">\n          <div>\n            <p>${a("Current Model:",!1)}</p>\n            <p>\n              ${"APU"===e?a("APU PN:",!1):""}\n              ${e.includes("ENG")?a("Engine Position:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${a("MSN:",!1)}</p>\n            <p>${"APU"===e?a("APU SN:",!1):""}\n              ${e.includes("ENG")?a("Engine SN:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${a("A/C FH",!0)}</p>\n            <p>${"APU"===e?a("APU TSN:",!1):""}\n              ${e.includes("ENG")?a("Engine TSN:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${a("A/C FC",!0)}</p>\n            <p>${"APU"===e?a("APU CSN:",!1):""}\n              ${e.includes("ENG")?a("Engine CSN:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${a("EASA BW",!0)}</p>\n            <p>${a("FAA BW",!0)}</p>\n          </div>\n        </div>  \n      `,d=function(e){switch(e){case 0:return.050372195;case 1:return.035456428;case 2:return.050372195;case 3:return.148010298;case 4:return.040372195;case 5:return.319537695;case 6:return.030372195;case 7:return.030372195;case 8:return.030372195;case 9:return.030372195;case 10:return.030372195;case 11:return.030372195;case 12:return.140372195;case 13:return.033273633}},u=function(e=!1){return`\n          font-size: 5px;\n          word-wrap: break-word;\n          border: .1px solid black;\n          text-align: center;\n          vertical-align: middle;\n          padding: 0;\n          ${!1!==e?`width: ${270*d(e)}mm`:""};\n        `};let h=l.map(((e,t)=>{const r=n.slice(1,15).map(((n,r)=>0===t?r<6||r>11?`\n                <th rowspan="3" style="\n                  ${u(r)}\n                  ${4===r||13===r?"padding-left: 5px; padding-right: 5px;":""}\n                ">\n                  ${e[n]}\n                </th>\n              `:6===r?`\n                <th colspan="6" style="\n                  ${u()}\n                ">\n                  ${e[n]}\n                </th>\n              `:"":1===t?6===r||9===r?`\n                <th colspan="3" style="\n                  ${u()}\n                ">\n                  ${e[n]}\n                </th>\n              `:"":r>=6&&r<=11?`\n                <th style="\n                  ${u(r)}\n                ">\n                  ${e[n]}\n                </th>\n              `:"")).filter((e=>""!==e)).join("");return`\n          <tr style="background: lightgrey;">\n            ${r}\n          </tr>\n        `})).join("");const p=function(e=!1){return`\n          font-size: 5px;\n          border: .1px solid black;\n          text-align: ${[0,1,4,6,7,8,9,10,11,13].includes(e)?"center":"justify"};\n          vertical-align: middle;\n          padding: 0 5px;\n          ${!1!==e?`width: ${270*d(e)}mm`:""} !important;\n        `},m=function(e=!1){return`\n          word-wrap: break-word;\n          overflow-wrap: break-word;\n          text-align: ${[0,1,4,6,7,8,9,10,11,13].includes(e)?"center":"justify"};\n          width: 100%;\n        `};let f=[];s.map(((e,t,r)=>{let i;if(void 0===e["col5"])i=!1;else{i=t+1;while(i<r.length&&i<t+this.maxRowsspan){if(void 0!==r[i]["col5"])break;i++}i-=t}let o=[];const l=n.slice(1,15).map(((t,n)=>{if(n>=5&&n<=12){let i;if("number"===typeof e[t]){var r=String(new Date(24*e[t]*3600*1e3-22091616e5));r=r.split(" "),i=`${r[2]}-${r[1]}-${r[3]}`}else i=e[t]?e[t].replaceAll("\n","<br>"):"-";return`\n              <td style="\n                  ${p(n)}\n                ">\n                <div style="${m(n)}">${i}</div>\n              </td>\n            `}if(!1!==i){let l;if(4===n||"number"===typeof e[t]){r=String(new Date(24*e[t]*3600*1e3-22091616e5));r=r.split(" "),l=`${r[2]}-${r[1]}-${r[3]}`}else l=e[t]?e[t].replaceAll("\n","<br>"):"";return o.push(`\n              <td rowspan="${i}" style="\n                  ${p(n)}\n                ">\n                <div style="${m(n)}">${l}</div>\n              </td>\n            `),`\n              <td rowspan="${i}" style="\n                  ${p(n)}\n                ">\n                <div style="${m(n)}">${l}</div>\n              </td>\n            `}})).join("");let s,a;!1===i&&(s=f.slice(-1)[0].rowspanCells.map((e=>e.replace(/rowspan=\"\d+\"/,`rowspan="${f.slice(-1)[0].rowspanNumber-1}"`))),a=`<tr>\n              ${s.slice(0,-1).join("")}\n              ${l}\n              ${s.slice(-1).join("")}\n            </tr>`),f.push({row:`<tr>${l}</tr>`,valid:!!i,rowspanNumber:i||f.slice(-1)[0].rowspanNumber-1,rowspanCells:i?o:s,rowNextPage:i?l:a})}));const b=function(e){let t=0;for(let i of e.split("<tr>").reverse())if(t++,i.includes('rowspan="'))break;const n=e.match(/rowspan=\"\d+\"/g),r=e.split(/rowspan=\"\d+\"/).reduce(((e,r,i,o)=>i===o.length-1?e+r:i>o.length-8?e+r+`rowspan="${t}"`:e+r+n[i]),"");return r},v=[];let w="";for(let g of f)if(""===w)w=h+g.row;else{const e=document.querySelector("#test-page");e.classList.remove("hidden"),e.innerHTML=`<div class="page">\n            <div class="header-and-table">\n              <div class="header">\n                \n              </div>\n              <table class="test-table">\n                ${w+g.row}\n              </table>\n            </div>          \n            <div class="footer">\n\n            </div>\n          </div>`;const t=.2645833333*document.querySelector(".test-table").offsetHeight>=180*this.tableHeightCorrector;e.innerHTML="",e.classList.add("hidden"),t?g.valid?(v.push({table:w}),w=h+g.row):(v.push({table:b(w)}),w=h+g.rowNextPage):w+=g.row}v.push({table:w}),this.html=v.map(((e,t,n)=>`<div class="${navigator.userAgent.includes("Firefox")?"page-firefox":"page"}">\n          <div class="header-and-table">\n            <div class="header">\n              ${c}\n            </div>\n            <table class="table">\n              ${e.table}\n            </table>\n          </div>          \n          <div class="${navigator.userAgent.includes("Firefox")?"footer-firefox":"footer"}">\n              <div class="first-row-footer">\n                <p>Prepared by: ${this.prepared}</p>\n              </div>\n              <div class="second-row-footer">\n                <p class="p-center">Checked by: ${this.checked}</p>\n                <p class="p-end">Page ${t+1} of ${n.length}</p>\n              </div>\n          </div>\n        </div>`)),this.splitIn2?this.html=[this.html.slice(0,Math.round(this.html.length/2)).join(""),this.html.slice(Math.round(this.html.length/2)).join("")]:this.html=this.html.join("")},downloadPDF(){try{this.splitIn2?this.html.forEach(((e,t)=>{setTimeout((()=>{localStorage.setItem("html",e),window.open("#/pdf-printer","_blank")}),1e3*t)})):(localStorage.setItem("html",this.html),window.open("#/pdf-printer","_blank"))}catch{this.showErrorMsg("The size for the PDF document is too big, please select the split it in 2 option.")}},showErrorMsg(e){this.msg=e;const t=document.querySelector("#modal-btn");t.classList.remove("hidden"),t.click(),t.classList.add("hidden")}},watch:{readyToPrint(e){setTimeout((()=>{e&&(document.querySelector(".printer-container").innerHTML=this.html)}),1e3)},worksheet(){this.html=""}}};const le=(0,c.Z)(oe,[["render",re]]);var se=le,ae={name:"PDFGeneratorView",components:{PDFGenerator:se}};const ce=(0,c.Z)(ae,[["render",T]]);var de=ce;function ue(e,t,n,r,o,l){const s=(0,i.up)("PDFPrinter");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s)])}const he=(0,i._)("div",{class:"printer-container"},null,-1),pe=[he];function me(e,t,n,r,o,l){return(0,i.wg)(),(0,i.iD)("div",null,pe)}var fe={name:"PDFPrinter",data(){return{html:localStorage.getItem("html")}},mounted(){setTimeout((()=>document.querySelector(".printer-container").innerHTML=this.html),1e3)}};const be=(0,c.Z)(fe,[["render",me]]);var ve=be,we={name:"PDFPrinterView",components:{PDFPrinter:ve}};const ge=(0,c.Z)(we,[["render",ue]]);var ye=ge;const _e=[{path:"/",name:"home",component:x},{path:"/pdf-generator",name:"pdf-generator",component:de},{path:"/pdf-printer",name:"pdf-printer",component:ye}],ke=(0,h.p7)({history:(0,h.r5)(),routes:_e});var $e=ke,Pe=(0,s.MT)({state:{readyToPrint:"false",htmlToPrint:""},getters:{readyToPrint(e){return"true"===e.readyToPrint},htmlToPrint(e){return e.htmlToPrint}},mutations:{setReadyToPrint(e,t){e.readyToPrint=t?"true":"false"},setHTMLToPrint(e,t){e.htmlToPrint=t}},actions:{},modules:{}});n(2166);(0,r.ri)(u).use(Pe).use($e).mount("#app")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,r,i,o){if(!r){var l=1/0;for(d=0;d<e.length;d++){r=e[d][0],i=e[d][1],o=e[d][2];for(var s=!0,a=0;a<r.length;a++)(!1&o||l>=o)&&Object.keys(n.O).every((function(e){return n.O[e](r[a])}))?r.splice(a--,1):(s=!1,o<l&&(l=o));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[r,i,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,o,l=r[0],s=r[1],a=r[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(a)var d=a(n)}for(t&&t(r);c<l.length;c++)o=l[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},r=self["webpackChunkproject"]=self["webpackChunkproject"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(8185)}));r=n.O(r)})();
//# sourceMappingURL=app.bc41989e.js.map