(function(){"use strict";var e={9930:function(e,t,n){var r=n(9242),o=n(3396);const i={key:0};function s(e,t,n,r,s,a){const l=(0,o.up)("router-link"),c=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,["pdf-printer"!==e.$route.name?((0,o.wg)(),(0,o.iD)("nav",i,[(0,o.Wm)(l,{class:"nav-element",to:{name:"home"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Home")])),_:1}),(0,o.Wm)(l,{class:"nav-element",to:{name:"pdf-generator"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Application")])),_:1})])):(0,o.kq)("",!0),(0,o.Wm)(c)],64)}var a=n(65),l={computed:{...(0,a.Se)(["readyToPrint"])}},c=n(89);const d=(0,c.Z)(l,[["render",s]]);var h=d,u=n(2483);function p(e,t,n,r,i,s){const a=(0,o.up)("Home");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(a)])}n(7658);const m=(0,o._)("div",{class:"background"},null,-1),f={class:"main-container"},b=(0,o._)("h1",null," ADCL to PDF CREATOR ",-1),w=(0,o._)("p",null," With this AD PDF CREATOR tool, you will be able to get a stylish PDF document from the excel file with just one step. ",-1),v=(0,o.uE)("<ol><li> Set the preparation and checked value with the initials of the people that did it. </li><li> Import the excel file with all the information. </li><li> Once the excel file is imported, select the sheet you want to get as PDF. </li><li> After these settings, there are 2 number parameters: the height coefficient corrector and the max number of row span. <br><br> The first one is to regulate the space for the table in the pages, the closest to 1 the less space will be left, and otherwise. The default number is the recommended for each browser, using firefox there may be some pages with the header moved to the top, if thats the case reduce this number to get a more well distributed space for the pdf pages. In other browsers this problem does not happen, however check allways that the tqble does not collapse with the header nor the footer, just in case, this will not take much time. The max rowspan value is to set the maximum rows that are span inside the excel sheet about to transform. Rarely it will be cases with more than 50 rows spanned (default number), but in case there are, set this parameter correctly. <br><br> If there are a lot of rows (like in the AIRFRAME sheet), the program may can not create the pdf in 1 document. For these cases, a message will display showing that there is a problem. To solve it you will have to select the &quot;split in 2&quot; option. Then, you will get 2 documents (instead of 1) that can be join later on with any PDF tool. Be aware that it be necessari to give access to the browser to open an emergent window for the second document. If the second document does not open even after allowed, just click on the download again (step 6) and it will open this time </li><li> Once all the setup is done, the TRANSFORM button will be activated, click it to start the transformation. </li><li> With the PDF created, click the download button to open a new tab with the PDF document ready to be printed. In the cases where the &quot;split in 2&quot; option is selected, 2 new tabs will be opened. Allow for this site to open an emergent window if asks, it will be the 2nd half of the document. </li><li> Finally, once the new tab is opened, print the pages with Ctrl+P, and before start the printing, set the printer to “save as PDF”, set the page size as A4, unselect the “print the header and footer” option, and set the margins to none. </li></ol>",1);function g(e,t,n,r,i,s){return(0,o.wg)(),(0,o.iD)("div",null,[m,(0,o._)("div",f,[b,w,(0,o._)("p",null,[(0,o.Uk)(" For that, go to the "),(0,o._)("button",{class:"inline-btn",onClick:t[0]||(t[0]=t=>e.$router.push({name:"pdf-generator"}))},"APPLICATION"),(0,o.Uk)(" tab follow these next steps: ")]),v])])}var y={name:"Home"};const k=(0,c.Z)(y,[["render",g]]);var $=k,_={name:"HomeView",components:{Home:$}};const P=(0,c.Z)(_,[["render",p]]);var x=P;function C(e,t,n,r,i,s){const a=(0,o.up)("PDFGenerator");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(a)])}var F=n(7139);const T=(0,o._)("div",{class:"background"},null,-1),A={id:"main-container",class:"p-5 text-center border rounded-5 shadow bg-white"},D={class:"inputs-container"},S={class:"name-inputs-container"},O=(0,o._)("p",null," Prepared by: ",-1),j=(0,o._)("p",null," Checked by: ",-1),H={class:"excel-selector-containers"},M={class:"file-input-container"},R=(0,o._)("p",null," Select the excel file: ",-1),N={class:"worksheet-selector-container"},E=(0,o._)("p",null," Select the sheet: ",-1),I=["disabled"],L={key:0,value:""},q=(0,o._)("p",null,"-- select an option --",-1),U=[q],W=["value"],z={class:"printed-parameters-container"},G=(0,o._)("p",null," Set the table height coeficient corrector: ",-1),V=(0,o._)("p",null," Set the maximum value of rowspan in the excel file: ",-1),Z={class:"checkbox-container"},B=(0,o._)("label",{for:"checkbox-split"}," Split the document in 2 ",-1),Y={class:"buttons-container"},K=(0,o._)("div",{id:"test-page",class:"prinet-container hidden"},null,-1),Q=(0,o._)("button",{id:"modal-btn",type:"button",class:"btn btn-primary hidden","data-bs-toggle":"modal","data-bs-target":"#msgModal"},null,-1),J={class:"modal fade",id:"msgModal",tabindex:"-1","aria-labelledby":"msgModalLabel","aria-hidden":"true"},X={class:"modal-dialog"},ee={class:"modal-content"},te=(0,o._)("div",{class:"modal-header"},[(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ne={class:"modal-body modal-body-style"};function re(e,t,n,i,s,a){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",null,[T,(0,o._)("div",A,[(0,o._)("div",D,[(0,o._)("div",S,[(0,o._)("div",null,[O,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>s.prepared=e)},null,512),[[r.nr,s.prepared]])]),(0,o._)("div",null,[j,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>s.checked=e)},null,512),[[r.nr,s.checked]])])]),(0,o._)("div",H,[(0,o._)("div",M,[R,(0,o._)("input",{id:"input-file",class:"form-control",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel, .xlsm",onChange:t[2]||(t[2]=(...e)=>a.readFile&&a.readFile(...e))},null,32)]),(0,o._)("div",N,[E,(0,o.wy)((0,o._)("select",{class:(0,F.C_)([""===s.workbook?"disabled-select":""]),disabled:""===s.workbook,"onUpdate:modelValue":t[3]||(t[3]=e=>s.worksheet=e)},[0===s.worksheet.length?((0,o.wg)(),(0,o.iD)("option",L,U)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.workbook.SheetNames,((e,t)=>((0,o.wg)(),(0,o.iD)("option",{key:t,value:e},(0,F.zw)(e),9,W)))),128))],10,I),[[r.bM,s.worksheet]])])])]),(0,o._)("div",z,[(0,o._)("div",null,[G,(0,o._)("div",null,[(0,o._)("button",{onClick:t[4]||(t[4]=()=>{this.tableHeightCorrector>.5&&(this.tableHeightCorrector-=.01),this.tableHeightCorrector=Math.round(100*this.tableHeightCorrector)/100})},"➖"),(0,o._)("p",null,(0,F.zw)(s.tableHeightCorrector),1),(0,o._)("button",{onClick:t[5]||(t[5]=()=>{this.tableHeightCorrector<1&&(this.tableHeightCorrector+=.01),this.tableHeightCorrector=Math.round(100*this.tableHeightCorrector)/100})},"➕")])]),(0,o._)("div",null,[V,(0,o._)("div",null,[(0,o._)("button",{onClick:t[6]||(t[6]=()=>{this.maxRowsspan>1&&this.maxRowsspan--,this.maxRowsspan=Math.round(this.maxRowsspan)})},"➖"),(0,o._)("p",null,(0,F.zw)(s.maxRowsspan),1),(0,o._)("button",{onClick:t[7]||(t[7]=()=>{this.maxRowsspan++,this.maxRowsspan=Math.round(this.maxRowsspan)})},"➕")])]),(0,o._)("div",Z,[(0,o.wy)((0,o._)("input",{id:"checkbox-split",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>s.splitIn2=e)},null,512),[[r.e8,s.splitIn2]]),B])]),(0,o._)("div",Y,[(0,o._)("button",{class:(0,F.C_)(["btn btn-primary",[""===this.worksheet||""===this.prepared||""===this.checked?"disabled":""]]),onClick:t[9]||(t[9]=(...e)=>a.transformFile&&a.transformFile(...e))},"TRANSFORM",2),(0,o._)("button",{class:(0,F.C_)(["btn",[""===this.html?"disabled btn-secondary":"btn-success"]]),onClick:t[10]||(t[10]=(...e)=>a.downloadPDF&&a.downloadPDF(...e))},"DOWNLOAD",2)])]),K]),Q,(0,o._)("div",J,[(0,o._)("div",X,[(0,o._)("div",ee,[te,(0,o._)("div",ne," Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quam autem facilis maiores! Accusamus nemo, a nesciunt molestiae harum exercitationem. Odio dolores error, ullam quos quisquam architecto at vel tempora autem. "+(0,F.zw)(s.msg),1)])])])])}const oe=n(7092);var ie={name:"PDFGenerator",data(){return{workbook:"",worksheet:"",prepared:"",checked:"",maxTableHeight:180,tableHeightCorrector:navigator.userAgent.includes("Firefox")?.9:.98,maxRowsspan:50,splitIn2:!1,msg:"",html:""}},computed:{...(0,a.Se)(["readyToPrint"])},methods:{...(0,a.OI)(["setReadyToPrint","setHTMLToPrint"]),readFile(){const e=document.querySelector("#input-file");this.file=e.files[0];const t=new FileReader;t.onload=e=>{const t=e.target.result,n=oe.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){const e=this.worksheet,t=this.workbook.Sheets[e],n=Array.apply(null,Array(18)).map(((e,t)=>`col${t}`)),r=oe.utils.sheet_to_json(t,{header:n});let o=0;while(o<10){if(Object.values(r[o]).includes("AD REF"))break;o++}const i=r.slice(0,o),s=r.slice(o,o+3);let a;a="end of report"===Object.values(r.slice(-1)[0])[0].toLowerCase()?r.slice(o+3,-1):r.slice(o+3);const l=function(e,t){return t?i.map((t=>{let n;if(Object.values(t).forEach((t=>{t.includes(e)&&(n=t.includes(": ")?t:t.replace(":",": "))})),n)return n})).filter((e=>void 0!==e)):e+" "+i.map((t=>{if(Object.values(t).includes(e)){const n=Object.values(t).indexOf(e);return Object.values(t)[n+1]}})).filter((e=>void 0!==e))},c=`\n        <div class="first-row-header">\n          <div class="img-header-container">\n            <img src="Airbus_Logo_2017.svg.png">\n          </div>\n          <div class="title-header-container">\n            <p>${l("Airworthiness Directives",!0)}</p>\n          </div>\n          <div class="valid-header-container">\n            <p>${l("Valid as of",!0)}</p>\n          </div>\n        </div>\n        <div class="second-row-header">\n          <div>\n            <p>${l("Current Model:",!1)}</p>\n            <p>\n              ${"APU"===e?l("APU PN:",!1):""}\n              ${e.includes("ENG")?l("Engine Position:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${l("MSN:",!1)}</p>\n            <p>${"APU"===e?l("APU SN:",!1):""}\n              ${e.includes("ENG")?l("Engine SN:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${l("A/C FH",!0)} FH</p>\n            <p>${"APU"===e?l("APU TSN:",!1):""}\n              ${e.includes("ENG")?l("Engine TSN:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${l("A/C FC",!0)} FC</p>\n            <p>${"APU"===e?l("APU CSN:",!1):""}\n              ${e.includes("ENG")?l("Engine CSN:",!1):""}\n            </p>\n          </div>\n\n          <div>\n            <p>${l("EASA BW",!0)}</p>\n            <p>${l("FAA BW",!0)}</p>\n          </div>\n        </div>  \n      `,d=function(e){switch(e){case 0:return.050372195;case 1:return.035456428;case 2:return.050372195;case 3:return.148010298;case 4:return.040372195;case 5:return.319537695;case 6:return.030372195;case 7:return.030372195;case 8:return.030372195;case 9:return.030372195;case 10:return.030372195;case 11:return.030372195;case 12:return.140372195;case 13:return.033273633}},h=function(e=!1){return`\n          font-size: 5px;\n          word-wrap: break-word;\n          border: .1px solid black;\n          text-align: center;\n          vertical-align: middle;\n          padding: 0;\n          ${!1!==e?`width: ${270*d(e)}mm`:""};\n        `};let u=s.map(((e,t)=>{const r=n.slice(1,15).map(((n,r)=>0===t?r<6||r>11?`\n                <th rowspan="3" style="\n                  ${h(r)}\n                  ${4===r||13===r?"padding-left: 5px; padding-right: 5px;":""}\n                ">\n                  ${e[n]}\n                </th>\n              `:6===r?`\n                <th colspan="6" style="\n                  ${h()}\n                ">\n                  ${e[n]}\n                </th>\n              `:"":1===t?6===r||9===r?`\n                <th colspan="3" style="\n                  ${h()}\n                ">\n                  ${e[n]}\n                </th>\n              `:"":r>=6&&r<=11?`\n                <th style="\n                  ${h(r)}\n                ">\n                  ${e[n]}\n                </th>\n              `:"")).filter((e=>""!==e)).join("");return`\n          <tr style="background: lightgrey;">\n            ${r}\n          </tr>\n        `})).join("");const p=function(e=!1,t=!1){return`\n          font-size: 5px;\n          border: .1px solid black;\n          vertical-align: middle;\n          padding: 0 5px;\n          ${!1!==e?`width: ${270*d(e)}mm`:""} !important;\n          background-color: ${t?"yellow":""};\n        `},m=function(e=!1){return`\n          word-wrap: break-word;\n          overflow-wrap: break-word;\n          text-align: ${[0,1,4,6,7,8,9,10,11,13].includes(e)?"center":[2].includes(e)?"start":"justify"};\n          width: 100%;\n        `};let f=[];a.map(((e,t,r)=>{let o;if(void 0===e["col5"])o=!1;else{o=t+1;while(o<r.length&&o<t+this.maxRowsspan){if(void 0!==r[o]["col5"])break;o++}o-=t}let i=[],s=!1;(!1!==o&&void 0!==e["col17"]||!1===o&&f.slice(-1)[0].highlight)&&(s=!0);const a=n.slice(1,15).map(((t,n)=>{if(n>=5&&n<=12){let o;if("number"===typeof e[t]){var r=String(new Date(24*e[t]*3600*1e3-22091616e5));r=r.split(" "),o=`${r[2]}-${r[1]}-${r[3]}`}else o=e[t]?e[t].replaceAll("\n","<br>"):"-";return`\n              <td style="\n                  ${p(n,s)}\n                ">\n                <div style="${m(n)}">${o}</div>\n              </td>\n            `}if(!1!==o){let a;if(4===n||"number"===typeof e[t]){r=String(new Date(24*e[t]*3600*1e3-22091616e5));r=r.split(" "),a=`${r[2]}-${r[1]}-${r[3]}`}else a=1===n?e[t]?e[t].replaceAll("\n","<br>"):"-":e[t]?e[t].replaceAll("\n","<br>"):"";return i.push(`\n              <td rowspan="${o}" style="\n                  ${p(n,s)}\n                ">\n                <div style="${m(n)}">${[0,1].includes(n)&&0!==a.trim().length&&"-"!==a.trim()?`${a}<br>« Cont'd »`:a}</div>\n              </td>\n            `),`\n              <td rowspan="${o}" style="\n                  ${p(n,s)}\n                ">\n                <div style="${m(n)}">${a}</div>\n              </td>\n            `}})).join("");let l,c;!1===o&&(l=f.slice(-1)[0].rowspanCells.map((e=>e.replace(/rowspan=\"\d+\"/,`rowspan="${f.slice(-1)[0].rowspanNumber-1}"`))),c=`<tr>\n              ${l.slice(0,-1).join("")}\n              ${a}\n              ${l.slice(-1).join("")}\n            </tr>`),f.push({row:`<tr>${a}</tr>`,valid:!!o,rowspanNumber:o||f.slice(-1)[0].rowspanNumber-1,rowspanCells:o?i:l,rowNextPage:o?a:c,highlight:s})}));const b=function(e){let t=0;for(let o of e.split("<tr>").reverse())if(t++,o.includes('rowspan="'))break;const n=e.match(/rowspan=\"\d+\"/g),r=e.split(/rowspan=\"\d+\"/).reduce(((e,r,o,i)=>o===i.length-1?e+r:o>i.length-8?e+r+`rowspan="${t}"`:e+r+n[o]),"");return r},w=[];let v="";for(let g of f)if(""===v)v=u+g.row;else{const e=document.querySelector("#test-page");e.classList.remove("hidden"),e.innerHTML=`<div class="page">\n            <div class="header-and-table">\n              <div class="header">\n                \n              </div>\n              <table class="test-table">\n                ${v+g.row}\n              </table>\n            </div>          \n            <div class="footer">\n\n            </div>\n          </div>`;const t=.2645833333*document.querySelector(".test-table").offsetHeight>=180*this.tableHeightCorrector;e.innerHTML="",e.classList.add("hidden"),t?g.valid?(w.push({table:v}),v=u+g.row):(w.push({table:b(v)}),v=u+g.rowNextPage):v+=g.row}v+='<tr>\n        <td colspan="14" style="font-size: 5px;\n        font-weight: bold;\n        text-align: center;\n        margin: 0;\n        padding: 0;\n        border: none;">\n          End of Report\n        </td>\n      </tr>',w.push({table:v}),this.html=w.map(((e,t,n)=>`<div class="${navigator.userAgent.includes("Firefox")?"page-firefox":"page"}">\n          <div class="header-and-table">\n            <div class="header">\n              ${c}\n            </div>\n            <table class="table">\n              ${e.table}\n            </table>\n          </div>          \n          <div class="${navigator.userAgent.includes("Firefox")?"footer-firefox":"footer"}">\n              <div class="first-row-footer">\n                <p>Prepared by: ${this.prepared}</p>\n              </div>\n              <div class="second-row-footer">\n                <p class="p-center">Checked by: ${this.checked}</p>\n                <p class="p-end">Page ${t+1} of ${n.length}</p>\n              </div>\n          </div>\n        </div>`)),this.splitIn2?this.html=[this.html.slice(0,Math.round(this.html.length/2)).join(""),this.html.slice(Math.round(this.html.length/2)).join("")]:this.html=this.html.join("")},downloadPDF(){try{this.splitIn2?this.html.forEach(((e,t)=>{setTimeout((()=>{localStorage.setItem("html",e),window.open("#/pdf-printer","_blank")}),1e3*t)})):(localStorage.setItem("html",this.html),window.open("#/pdf-printer","_blank"))}catch{this.showErrorMsg("The size for the PDF document is too big, please select the split it in 2 option.")}},showErrorMsg(e){this.msg=e;const t=document.querySelector("#modal-btn");t.classList.remove("hidden"),t.click(),t.classList.add("hidden")}},watch:{readyToPrint(e){setTimeout((()=>{e&&(document.querySelector(".printer-container").innerHTML=this.html)}),1e3)},worksheet(){this.html=""},splitIn2(){this.html=""}}};const se=(0,c.Z)(ie,[["render",re]]);var ae=se,le={name:"PDFGeneratorView",components:{PDFGenerator:ae}};const ce=(0,c.Z)(le,[["render",C]]);var de=ce;function he(e,t,n,r,i,s){const a=(0,o.up)("PDFPrinter");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(a)])}const ue=(0,o._)("div",{class:"printer-container"},null,-1),pe=[ue];function me(e,t,n,r,i,s){return(0,o.wg)(),(0,o.iD)("div",null,pe)}var fe={name:"PDFPrinter",data(){return{html:localStorage.getItem("html")}},mounted(){setTimeout((()=>document.querySelector(".printer-container").innerHTML=this.html),1e3)}};const be=(0,c.Z)(fe,[["render",me]]);var we=be,ve={name:"PDFPrinterView",components:{PDFPrinter:we}};const ge=(0,c.Z)(ve,[["render",he]]);var ye=ge;const ke=[{path:"/",name:"home",component:x},{path:"/pdf-generator",name:"pdf-generator",component:de},{path:"/pdf-printer",name:"pdf-printer",component:ye}],$e=(0,u.p7)({history:(0,u.r5)(),routes:ke});var _e=$e,Pe=(0,a.MT)({state:{readyToPrint:"false",htmlToPrint:""},getters:{readyToPrint(e){return"true"===e.readyToPrint},htmlToPrint(e){return e.htmlToPrint}},mutations:{setReadyToPrint(e,t){e.readyToPrint=t?"true":"false"},setHTMLToPrint(e,t){e.htmlToPrint=t}},actions:{},modules:{}});n(2166);(0,r.ri)(h).use(Pe).use(_e).mount("#app")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,i){if(!r){var s=1/0;for(d=0;d<e.length;d++){r=e[d][0],o=e[d][1],i=e[d][2];for(var a=!0,l=0;l<r.length;l++)(!1&i||s>=i)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(a=!1,i<s&&(s=i));if(a){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[r,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,i,s=r[0],a=r[1],l=r[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var d=l(n)}for(t&&t(r);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},r=self["webpackChunkproject"]=self["webpackChunkproject"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(9930)}));r=n.O(r)})();
//# sourceMappingURL=app.03df77a8.js.map